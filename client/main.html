<head>
  <title>doichain-bounty</title>
</head>

<body>
In order to block a Doichain bounty, you must be logged in please {{> loginButtons}}!
  <h1>Welcome to Doichain bounties!</h1>
  {{> reactiveTable collection=bounties fields=fields rowsPerPage=50}}

{{#if isInRole 'admin'}}<input type="button" value="SyncWithGithUb" class="gitHubSync">{{/if}}
</body>

<template name="bountyMain">
    <p>
        <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse{{github_id}}" aria-expanded="false" aria-controls="collapse{{github_id}}">
            {{title}}
        </button>
    </p>
    <div class="collapse" id="collapse{{github_id}}">
        <div class="card card-body">
            {{#markdown}}{{body}}{{/markdown}}
            <br>
            <a href="{{html_url}}" target='_blank'>Open on GitHub</a>
        </div>
    </div>
</template>

<template name="labels">
    {{#each labels}}
        <span class="badge badge-pill" style="background-color:#{{this.color}}">{{this.name}}</span>
    {{/each}}
</template>

<template name="bountyEur">
    {{#if isInRole 'admin'}}
        <input type="text" value="{{bountyEur}}" class="bountyEur">
    {{else}}
        {{bountyEur}}
    {{/if}}
</template>

<template name="bountyDoi">
{{#if isInRole 'admin'}}
    <input type="text" value="{{bountyDoi}}" class="bountyDoi">
{{else}}
    {{bountyDoi}}
{{/if}}
</template>

<template name="priority">
{{#if isInRole 'admin'}}
    <select class="priority">
        {{#each priorityEements}}
            <option {{prioritySelected this ../priority}}>{{this}}</option>
        {{/each}}
    </select>
{{else}}
    {{priority}}
{{/if}}
</template>

<template name="blockBounty">
    {{#if currentUser }}

        {{#unless isInRole 'admin'}}
            {{#if blockedBy}}
                state: {{blockedBy.state}} <br>
                by: {{blockedBy.by}} <br>
                until:  {{blockedBy.blockedUntil}}
                {{#if isState 'cancelled'}}
                    <input type="button" value="Block" class="blockBounty">
                {{/if}}
                {{#if isState 'blocked'}}
                    {{#if isMine}}
                        <input type="button" value="Cancel" class="cancelBounty">
                        <input type="button" value="Request Approval" class="requestApproval">
                    {{/if}}
                {{/if}}
            {{else}}
                <input type="button" value="Block" class="blockBounty">
            {{/if}}
        {{/unless}}

        {{#if isInRole 'admin'}}
            {{#if blockedBy}}
                state: {{blockedBy.state}} <br>
                by: {{blockedBy.by}} <br>
                until:  {{blockedBy.blockedUntil}}
                {{#if isState 'cancelled'}}
                    <input type="button" value="Block" class="blockBounty">
                {{/if}}
                {{#if isState 'blocked'}}
                    <input type="button" value="Cancel" class="cancelBounty">
                {{/if}}
                {{#if isState 'under review'}}
                    <input type="button" value="Approve" class="approveBounty">
                    <input type="button" value="Cancel" class="cancelBounty">
                {{/if}}
            {{else}}
                <input type="button" value="Block" class="blockBounty">
            {{/if}}
        {{/if}}
    {{/if}}
</template>

